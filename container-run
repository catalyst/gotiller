# Use transparently: container-run go test, container-run ./cover, container-run go build etc.

IMAGE=go-1.15

WORKDIR=/gotiller

DIR=`dirname $0`
if [ "${DIR%%/}" = "." ]
then
    DIR=$PWD/$DIR
fi

docker build -q -t $IMAGE -f Dockerfile.$IMAGE $DIR

PKGDIR=/tmp/$USER/pkg-cache
mkdir -p $PKGDIR

docker run --rm -v $DIR:$WORKDIR -v $PKGDIR:/go/pkg -w $WORKDIR $IMAGE "$@"
